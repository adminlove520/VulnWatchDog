# CVE-2021-3129-Laravel-Remote-Code-Execution

**漏洞编号:** CVE-2021-3129  
**漏洞类型:** 远程代码执行  
**影响应用:** Laravel (Ignition组件)  
**危害等级:** 高危，可能导致远程代码执行  
**影响版本:** Ignition< 2.5.2, Laravel < 8.4.2  
**利用条件:** 需要目标系统开启Debug模式  
**POC 可用性:** 是  
**投毒风险:** 5%

## 概要

## 漏洞概述

CVE-2021-3129是一个影响Laravel框架Ignition组件的远程代码执行漏洞。该漏洞源于Ignition组件在Debug模式下对`file_get_contents()`和`file_put_contents()`函数的不安全使用，允许未认证的攻击者执行任意代码。

## 有效性分析

该CVE编号格式正确，由NVD和CISA等权威机构收录，CVSS评分为9.8（CRITICAL）。漏洞描述详细，包含完整的技术细节和修复建议，参考链接丰富，包括GitHub、安全博客和官方公告。因此该CVE是真实有效的。

## 投毒风险分析

提供的POC代码主要用于演示漏洞利用，代码结构清晰，没有包含明显的恶意代码或后门。投毒风险较低（约5%），主要风险可能来自第三方依赖（如phpggc）而非主POC代码本身。

## 利用方式

1. 目标系统必须开启Debug模式

2. 攻击者清空Laravel日志文件（如laravel.log）

3. 利用`php://filter/write=`写入PHAR反序列化payload

4. 发送请求触发`file_get_contents()`执行恶意代码

5. 关键步骤需要phpggc工具生成payload

## 代码分析

POC代码主要包含以下组件：
- `CVE-2021-3129.py`: 主漏洞利用脚本
- 多种攻击链（LARAVEL_CHAINS和MONOLOG_CHAINS）

- phpggc集成用于生成反序列化payload
代码执行流程：

1. 检测目标是否开启Debug模式

2. 清空日志文件

3. 生成PHAR反序列化payload

4. 写入payload到日志文件

5. 触发反序列化执行任意代码

## 参考链接

- 漏洞利用：[joshuavanderpoll/CVE-2021-3129](https://github.com/joshuavanderpoll/CVE-2021-3129)  
- 漏洞详情：[CVE-2021-3129](https://nvd.nist.gov/vuln/detail/CVE-2021-3129)

## 相关文章

- [Laravel RCE（CVE-2021-3129）漏洞复现 - FreeBuf网络安全 ...](https://www.freebuf.com/vuls/280508.html)
- [Laravel Debug mode RCE漏洞（CVE-2021-3129）poc / exp](https://github.com/ajisai-babu/CVE-2021-3129-exp)
- [Laravel远程代码执行 (CVE-2021-3129)漏洞复现 | 小风风のblog](https://windeskybb.work/archives/4752b674-6c21-42d3-a06f-8bba6b800b92)
- [laravel RCE（cve-2021-3129）复现 - Running_J - 博客园](https://www.cnblogs.com/ArcherCY/p/17735493.html)
- [Laravel RCE CVE-2021-3129 | Hacker进化论](https://sxksec.cn/2024/12/31/lou-dong-zhi-shi-ku/laravel-rce-cve-2021-3129/)