# CVE-2019-11043-PHP-FPM远程代码执行

**漏洞编号:** CVE-2019-11043  
**漏洞类型:** 远程代码执行  
**影响应用:** PHP-FPM  
**危害等级:** 高危，可能导致远程代码执行  
**影响版本:** PHP 7.1.x < 7.1.33, 7.2.x < 7.2.24, 7.3.x < 7.3.11  
**利用条件:** 需要Nginx与PHP-FPM配置不当  
**POC 可用性:** 是  
**投毒风险:** 10%

## 概要

## 漏洞概述

CVE-2019-11043是一个影响PHP-FPM的远程代码执行漏洞，攻击者可以通过构造恶意请求，利用Nginx与PHP-FPM的配置不当，导致缓冲区溢出，从而执行任意代码。该漏洞影响PHP 7.1.x、7.2.x和7.3.x的特定版本。

## 有效性分析

该CVE由多个权威机构（如NVD、CISA、OSCS）收录，漏洞描述详细，包含完整的技术细节和修复建议。CVSS评分为8.7，属于高危漏洞。参考链接丰富，包括Debian、Red Hat等官方公告，因此该CVE是真实有效的。

## 投毒风险分析

提供的POC代码主要用于演示漏洞利用，代码结构清晰，未发现隐藏的恶意代码或后门。投毒风险较低（约10%），仅包含必要的漏洞验证逻辑。

## 利用方式

1. 攻击者需要目标服务器运行Nginx与PHP-FPM，且配置不当。

2. 构造包含特殊字符（如%0a）的请求，破坏`fastcgi_split_path_info`的正则表达式。
3. 发送恶意请求到目标服务器，触发缓冲区溢出。

4. 利用溢出漏洞执行任意代码或建立反向隧道。

## 代码分析

POC代码主要包含以下组件：
- `exploit.go`：主漏洞利用脚本，用于构造恶意请求。

- `payloads.go`：包含攻击载荷，用于触发缓冲区溢出。代码执行流程：

1. 检测目标服务器是否运行Nginx与PHP-FPM。

2. 构造恶意请求，包含特殊字符（%0a）。
3. 发送请求到目标服务器，触发漏洞。

4. 利用溢出漏洞执行任意代码或建立反向隧道。

## 参考链接

- 漏洞利用：[AndrewMas99/CVE-2019-11043-Vulnerability](https://github.com/AndrewMas99/CVE-2019-11043-Vulnerability)  
- 漏洞详情：[CVE-2019-11043](https://nvd.nist.gov/vuln/detail/CVE-2019-11043)

## 相关文章

- [PoC CVE-2019-11043 - GitHub](https://github.com/kriskhub/CVE-2019-11043)
- [CVE-2019-11043漏洞分析与复现 - STong66 - 博客园](https://www.cnblogs.com/st66/p/14735800.html)
- [Exploit とか PoC とか呼ばれるものを触ってみる #nginx - Qiita](https://qiita.com/aucfan-nodake/items/ff2056ec5d77c0d2a49d)
- [【漏洞复现】CVE-2019-11043（PHP远程代码执行漏洞 ...](https://blog.csdn.net/Thmos_vader/article/details/139154799)
- [[CVE-2019–11043]: Exploiting the PHuiP-FPizdaM Vulnerability](https://ine.com/blog/cve-201911043-exploiting-the-phuip-fpizdam-vulnerability)