# CVE-2025-49844-Redis-Lua-UAF

**漏洞编号:** CVE-2025-49844  
**漏洞类型:** 远程代码执行  
**影响应用:** Redis  
**危害等级:** 高危，可能导致远程代码执行  
**影响版本:** <= 8.2.1  
**利用条件:** 需要已验证的用户权限和执行Lua脚本的能力  
**POC 可用性:** 是  
**投毒风险:** 10%

## 概要

## 漏洞概述

CVE-2025-49844是一个影响Redis的严重漏洞，存在于其Lua脚本解析器中。攻击者可以通过精心构造的Lua脚本触发垃圾回收器的异常行为，导致释放后使用（UAF），最终可能实现远程代码执行。该漏洞影响所有支持Lua脚本解析的Redis版本，并在8.2.2版本中修复。## 有效性分析

该CVE由NVD和OSCS等权威漏洞库收录，CVSS评分为9.9（CRITICAL），且提供了详细的技术描述和修复链接。漏洞描述清晰，并有多个开源社区的参考链接，因此该CVE是真实有效的。## 投毒风险分析

提供的POC代码主要用于演示漏洞利用，未发现明显的恶意代码或后门。投毒风险较低，约为10%。## 利用方式

1. 攻击者需要获得Redis的已验证用户权限。2. 构造恶意的Lua脚本，利用垃圾回收器的漏洞触发UAF。3. 通过EVAL或EVALSHA命令执行脚本。4. 利用UAF漏洞实现代码注入和执行任意代码。## 代码分析

POC代码主要包含以下组件：- `exploit.lua`: 包含恶意Lua脚本，用于触发垃圾回收器异常。- `payload_generator.py`: 生成用于注入的恶意payload。- `redis_connector.py`: 提供与Redis实例的连接功能。代码执行流程：1. 连接到目标Redis实例。2. 加载并执行恶意Lua脚本。3. 通过UAF漏洞注入代码。4. 执行任意代码。

## 参考链接

- 漏洞利用：[Zain3311/CVE-2025-49844](https://github.com/Zain3311/CVE-2025-49844)  
- 漏洞详情：[CVE-2025-49844](https://nvd.nist.gov/vuln/detail/CVE-2025-49844)

## 相关文章

[GitHub - raminfp/redis_exploit: CVE-2025-49844 (RediShell)](https://github.com/raminfp/redis_exploit)
[PoC for CVE-2025-49844, CVE-2025-46817 and CVE-2025 ...](https://redrays.io/blog/poc-for-cve-2025-49844-cve-2025-46817-and-cve-2025-46818-critical-lua-engine-vulnerabilities/)
[Redis 7.4.5 Lua の脆弱性 CVE-2025-49844／46817／46818 ...](https://iototsecnews.jp/2025/10/08/poc-exploit-released-for-critical-vulnerabilities-in-lua-engine/)
[Security Advisory: CVE-2025-49844 | Redis](https://redis.io/blog/security-advisory-cve-2025-49844/)
[Wiz Finds Critical Redis RCE Vulnerability: CVE‑2025‑49844 ...](https://www.wiz.io/blog/wiz-research-redis-rce-cve-2025-49844)
[CVE-2025-49844 - Redis Lua Interpreter UAF Exploit - GitHub](https://github.com/Yuri08loveElaina/CVE-2025-49844)