# CVE-2025-0411-7-Zip-Mark-of-the-Web-Bypass

**漏洞编号:** CVE-2025-0411  
**漏洞类型:** 保护机制绕过  
**影响应用:** 7-Zip  
**危害等级:** 高危，可能导致任意代码执行  
**影响版本:** <= 24.09  
**利用条件:** 用户需打开恶意文件或访问恶意页面  
**POC 可用性:** 是  
**投毒风险:** 5%

## 概要

## 漏洞概述

CVE-2025-0411是7-Zip软件中的一个Mark-of-the-Web（MotW）保护机制绕过漏洞。攻击者可以利用此漏洞，通过特制的压缩文件绕过Windows的安全机制，导致提取的文件不继承MotW标记，从而可能执行任意代码。该漏洞需要用户交互（如打开恶意文件），CVSS评分为7.0，属于高危漏洞。

## 有效性分析

该CVE编号格式正确，漏洞描述详细，包含技术细节和修复建议。多个权威机构（如NVD、CISA、OSCS）收录了此漏洞，并提供了相关参考链接。此外，漏洞已被用于实际攻击（如针对乌克兰组织的攻击活动），进一步验证了其真实性和有效性。

## 投毒风险分析

提供的POC代码主要用于演示漏洞利用，代码结构清晰，未发现隐藏的恶意代码或后门。投毒风险较低（约5%），但仍建议在隔离环境中运行。

## 利用方式

1. 攻击者构造一个特制的压缩文件，包含恶意代码。

2. 诱使用户下载并打开该文件（例如通过钓鱼邮件或恶意网站）。

3. 用户使用7-Zip解压文件时，MotW标记不会被传递到解压后的文件。
4. 解压后的文件可以绕过Windows的安全警告，直接执行恶意代码。

## 代码分析

POC代码主要包含以下组件：
- `loader.cpp`：用于加载和执行恶意代码的加载器。

- 使用`VirtualAlloc`分配内存。

- 使用`RtlMoveMemory`将恶意代码复制到内存中。

- 使用`VirtualProtect`修改内存权限为可执行。

- 使用`CreateThread`创建线程执行恶意代码。代码执行流程：

1. 分配内存并加载恶意代码。

2. 修改内存权限为可执行。

3. 创建线程执行恶意代码。

4. 等待线程执行完成。

## 参考链接

- 漏洞利用：[dpextreme/7-Zip-CVE-2025-0411-POC](https://github.com/dpextreme/7-Zip-CVE-2025-0411-POC)  
- 漏洞详情：[CVE-2025-0411](https://nvd.nist.gov/vuln/detail/CVE-2025-0411)

## 相关文章

- [CVE-2025-0411：ウクライナの組織を標的としたゼロデイ攻撃 ...](https://www.trendmicro.com/ja_jp/research/25/b/cve-2025-0411-ukrainian-organizations-targeted.html)
- [7-Zip の MotW バイパスの脆弱性 CVE-2025-0411：PoC が ...](https://iototsecnews.jp/2025/01/26/poc-for-7-zip-cve-2025-0411-lets-attackers-bypass-motw-and-run-malicious-code/)
- [7-Zipの脆弱性CVE-2025-0411について公開されたPoC（概念 ...](https://nikkeimatome.com/?p=51659)
- [Exploit for Protection Mechanism Failure in 7-Zip CVE-2025-0411](https://sploitus.com/exploit?id=852ABEEA-D57D-59C1-8BD3-05B6D503AEC8)
- [PoC for 7-Zip CVE-2025-0411 Lets Attackers Bypass MotW ...](https://social.cyware.com/news/poc-for-7-zip-cve-2025-0411-lets-attackers-bypass-motw-and-run-malicious-code-852e72fb)