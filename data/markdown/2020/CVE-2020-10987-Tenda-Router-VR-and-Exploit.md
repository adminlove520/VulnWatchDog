## CVE-2020-10987-Tenda-AC15-命令注入

**漏洞编号:** CVE-2020-10987

**漏洞类型:** 命令注入

**影响应用:** Tenda AC15 AC1900

**危害等级:** 高危，可能导致远程代码执行

**影响版本:** 15.03.05.19

**利用条件:** 需要网络访问权限

**POC 可用性:** 是

**投毒风险:** 5%

## 详情

# 漏洞概述 该漏洞存在于Tenda AC15 AC1900路由器15.03.05.19版本的`/goform/setUsbUnload`端点，攻击者可以通过`deviceName`参数注入任意系统命令，导致远程代码执行。 ## 有效性分析 1. CVE编号格式符合标准(CVE-2020-10987) 2. 漏洞描述详细明确，指出了具体的端点、参数和影响 3. 存在多个可信来源的参考链接(NVD、CISA等) 4. 提供了详细的技术细节和POC验证 5. CVSS评分高达9.8(CRITICAL级别) 综合分析，该CVE是真实有效的。 ## 投毒风险分析 1. 仓库主体功能是展示漏洞利用方法 2. 未发现明显恶意代码 3. cfm_stub脚本仅模拟了必要功能 4. 投毒风险极低(5%) ## 利用方式 1. 攻击者需要网络访问目标路由器 2. 向`/goform/setUsbUnload`端点发送POST请求 3. 在`deviceName`参数中注入恶意命令 4. 命令将通过`doSystemCmd`函数执行 5. 获取系统权限或执行任意操作 ## 代码分析 主要漏洞代码位于httpd二进制文件中： 1. `formsetUsbUnload`函数接收`deviceName`参数 2. 直接传递给`doSystemCmd`执行 3. 无任何过滤或验证 POC关键组件： 1. qemu模拟环境搭建 2. 逆向工程分析(httpd和cfmd) 3. cfm_stub模拟cfmd服务 4. 通过POST请求触发漏洞 代码执行流程： 1. 搭建qemu模拟环境 2. 提取和逆向固件 3. 分析漏洞点 4. 构造恶意请求 5. 执行任意命令

**漏洞利用:** [Tenda-Router-VR-and-Exploit](https://github.com/lapinpt/Tenda-AC15-Firmware-V15.03.05.19-9061)

**漏洞详情:** [CVE-2020-10987](https://nvd.nist.gov/vuln/detail/CVE-2020-10987)

## 相关文章

暂无相关文章